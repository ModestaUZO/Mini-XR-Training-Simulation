<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Mini XR Worker Simulation</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <!-- Camera -->
      <a-entity id="camera" camera look-controls position="0 1.6 5"></a-entity>

      <!-- Light -->
      <a-entity light="type: ambient; intensity: 0.8"></a-entity>
      <a-entity light="type: directional; intensity: 0.5" position="0 10 10"></a-entity>

      <!-- Ground -->
      <a-plane rotation="-90 0 0" width="10" height="10" color="#7BC8A4"></a-plane>

      <!-- Worker placeholder -->
      <a-box id="worker" position="0 0.5 0" depth="0.5" height="1.5" width="0.5" color="#00FF00"></a-box>

      <!-- Floating Text Panel -->
      <a-entity id="infoPanel" position="0 2 0">
        <a-text id="taskText" value="" align="center" color="#000" width="4"></a-text>
        <a-text id="discomfortText" value="" position="0 -0.3 0" align="center" color="#000" width="4"></a-text>
      </a-entity>
    </a-scene>

    <script>
      // Load JSON data
      fetch('worker_task_data.json')
        .then(response => response.json())
        .then(data => {
          let index = 0;
          const worker = document.getElementById('worker');
          const taskText = document.getElementById('taskText');
          const discomfortText = document.getElementById('discomfortText');

          function updateWorker() {
            const entry = data[index];

            // Update worker color based on discomfort
            worker.setAttribute('color', entry.Color);

            // Rotate worker (simple demo using back angle)
            worker.setAttribute('rotation', {x: entry.BackAngle, y: 0, z: 0});

            // Update text panels
            taskText.setAttribute('value', `Task: ${entry.Task}\nWorker: ${entry.Worker}`);
            discomfortText.setAttribute('value', `Discomfort: ${entry.Discomfort}`);

            // Move to next task after 2 seconds
            index = (index + 1) % data.length;
          }

          // Update every 2 seconds
          setInterval(updateWorker, 2000);
          updateWorker(); // initial display
        });
    </script>
  </body>
</html>

